<!-- 
  ** DO NOT EDIT THIS FILE
  ** 
  ** This file was automatically generated. 
  ** 1) Make all changes to `README.yaml` 
  ** 2) Run `make init` (you only need to do this once)
  ** 3) Run`make readme` to rebuild this file. 
  -->
[![README Header][readme_header_img]][readme_header_link]

[![cloudopsworks][logo]](https://cloudops.works/)

# Terraform AWS Observability Synthetics Module




AWS Observability Synthetics Module for comprehensive monitoring and testing infrastructure. This module provides advanced management of AWS Synthetics canaries with features including URL endpoint monitoring, API testing, custom script execution, and VPC-based deployments. Supports CloudWatch integration for metrics and alarms with SNS notifications, organized canary grouping, and flexible configuration options for various monitoring scenarios.


---

This project is part of our comprehensive approach towards DevOps Acceleration. 
[<img align="right" title="Share via Email" width="24" height="24" src="https://docs.cloudops.works/images/ionicons/ios-mail.svg"/>][share_email]
[<img align="right" title="Share on Google+" width="24" height="24" src="https://docs.cloudops.works/images/ionicons/logo-googleplus.svg" />][share_googleplus]
[<img align="right" title="Share on Facebook" width="24" height="24" src="https://docs.cloudops.works/images/ionicons/logo-facebook.svg" />][share_facebook]
[<img align="right" title="Share on Reddit" width="24" height="24" src="https://docs.cloudops.works/images/ionicons/logo-reddit.svg" />][share_reddit]
[<img align="right" title="Share on LinkedIn" width="24" height="24" src="https://docs.cloudops.works/images/ionicons/logo-linkedin.svg" />][share_linkedin]
[<img align="right" title="Share on Twitter" width="24" height="24" src="https://docs.cloudops.works/images/ionicons/logo-twitter.svg" />][share_twitter]


[![Terraform Open Source Modules](https://docs.cloudops.works/images/terraform-open-source-modules.svg)][terraform_modules]



It's 100% Open Source and licensed under the [APACHE2](LICENSE).







We have [*lots of terraform modules*][terraform_modules] that are Open Source and we are trying to get them well-maintained!. Check them out!






## Introduction

This Terraform module provides comprehensive management of AWS Synthetics canaries for monitoring endpoints, APIs, and web applications. It supports:
- Organized canary groups for better resource management and logical separation
- VPC-based canary execution with custom subnet and security group configuration
- Flexible monitoring schedules with cron and rate expressions
- Configurable retention periods for test results and artifacts
- Environment variable management for custom script parameters
- CloudWatch alarms integration with customizable thresholds and conditions
- SNS notifications for monitoring results with multiple topic support
- Custom artifact storage in S3 with optional bucket creation
- Priority-based alarm configuration (P1-P5)
- Multiple assertion types for response validation
- Support for both API and URL monitoring scenarios

## Usage


**IMPORTANT:** The `master` branch is used in `source` just as an example. In your code, do not pin to `master` because there may be breaking changes between releases.
Instead pin to the release tag (e.g. `?ref=vX.Y.Z`) of one of our [latest releases](https://github.com/cloudopsworks/terraform-module-aws-observability-synthetics/releases).


Configure canaries using YAML format in your Terraform/Terragrunt configuration:

# Terraform Configuration
groups:
  - name: "monitoring-group"
    tags:
      Environment: "Production"
      Cost-Center: "Operations"
    canaries:
      - name: "endpoint-monitor"
        runtime_version: "syn-python-selenium-6.0"
        schedule_expression: "rate(5 minutes)"
        requests_type: "URL"
        description: "API Health Check Monitor"
        requests:
          - url: "https://api.example.com/health"
            method: "GET"
            headers:
              Content-Type: "application/json"
              Authorization: "Bearer ${env:API_TOKEN}"
            assertions:
              - type: "STATUS_CODE"
                operator: "EQUALS"
                value: 200
              - type: "RESPONSE_TIME"
                operator: "LESS_THAN"
                value: 2000
        run_config:
          timeout_in_seconds: 60
          memory_mb: 1024
        alarms:
          enabled: true
          priority: 2
          metric: "SuccessPercent"
          threshold: 90
          period: 300
          evaluation_periods: 2
          notifications:
            - sns_topic_name: "urgent-alerts"
        tags:
          Service: "API-Gateway"

# Terragrunt Configuration
# terragrunt.hcl
include "root" {
  path = find_in_parent_folders()
}

terraform {
  source = "cloudopsworks/terraform-module-aws-observability-synthetics//."
}

inputs = {
  create_artifacts_bucket = true
  artifacts_bucket       = "my-synthetics-artifacts"
  default_sns_topic_name = "monitoring-alerts"

  vpc = {
    vpc_id     = dependency.vpc.outputs.vpc_id
    subnet_ids = dependency.vpc.outputs.private_subnets
  }

  groups = [
    {
      name = "api-monitoring"
      canaries = [
        {
          name = "api-health"
          # ... canary configuration ...
        }
      ]
    }
  ]
}

## Quick Start

1. Prepare your AWS environment:
   - Create VPC and subnets for canary execution
   - Set up IAM permissions for Synthetics execution
   - Create S3 bucket for artifacts (optional, can be created by module)
   - Create SNS topics for notifications

2. Create Terraform/Terragrunt configuration:
   ```hcl
   module "synthetics" {
     source = "cloudopsworks/terraform-module-aws-observability-synthetics"
     version = "1.0.0"

     create_artifacts_bucket = true
     artifacts_bucket = "my-synthetics-artifacts"

     vpc = {
       vpc_id = "vpc-12345"
       subnet_ids = ["subnet-abc123"]
     }
   }
   ```

3. Define monitoring groups and canaries in YAML:
   ```yaml
   groups:
     - name: "api-monitoring"
       canaries:
         - name: "health-check"
           runtime_version: "syn-python-selenium-6.0"
           schedule_expression: "rate(5 minutes)"
   ```

4. Apply configuration:
   ```bash
   terraform init
   terraform plan
   terraform apply
   ```

5. Monitor results:
   - Check AWS Synthetics dashboard
   - View CloudWatch metrics
   - Configure additional alarms as needed


## Examples

```hcl
module "synthetics" {
  source = "cloudopsworks/terraform-module-aws-observability-synthetics"

  groups = [
    {
      name = "api-monitoring"
      canaries = [
        {
          name = "api-health"
          requests_type = "API"
          requests = [
            {
              url = "https://api.example.com/v1/status"
              method = "GET"
              assertions = [
                {
                  type = "STATUS_CODE"
                  operator = "EQUALS"
                  value = 200
                }
              ]
            }
          ]
        }
      ]
    }
  ]

  vpc = {
    vpc_id = "vpc-1234567"
    subnet_ids = ["subnet-abcdef"]
  }

  artifacts_bucket = "my-artifacts-bucket"
  sns_topic_name = "monitoring-alerts"
}
```



## Makefile Targets
```
Available targets:

  help                                Help screen
  help/all                            Display help for all targets
  help/short                          This help short screen
  lint                                Lint terraform/opentofu code
  tag                                 Tag the current version

```
## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | >= 1.3 |
| <a name="requirement_archive"></a> [archive](#requirement\_archive) | ~> 2.7 |
| <a name="requirement_aws"></a> [aws](#requirement\_aws) | ~> 6.2 |
| <a name="requirement_local"></a> [local](#requirement\_local) | ~> 2.5 |
| <a name="requirement_null"></a> [null](#requirement\_null) | ~> 3.2 |
| <a name="requirement_random"></a> [random](#requirement\_random) | ~> 3.5 |

## Providers

| Name | Version |
|------|---------|
| <a name="provider_archive"></a> [archive](#provider\_archive) | 2.7.1 |
| <a name="provider_aws"></a> [aws](#provider\_aws) | 6.3.0 |
| <a name="provider_local"></a> [local](#provider\_local) | 2.5.3 |
| <a name="provider_null"></a> [null](#provider\_null) | 3.2.4 |
| <a name="provider_random"></a> [random](#provider\_random) | 3.7.2 |

## Modules

| Name | Source | Version |
|------|--------|---------|
| <a name="module_synthetics_artifacts"></a> [synthetics\_artifacts](#module\_synthetics\_artifacts) | terraform-aws-modules/s3-bucket/aws | ~> 5.1 |
| <a name="module_tags"></a> [tags](#module\_tags) | cloudopsworks/tags/local | 1.0.9 |

## Resources

| Name | Type |
|------|------|
| [archive_file.script](https://registry.terraform.io/providers/hashicorp/archive/latest/docs/resources/file) | resource |
| [aws_cloudwatch_metric_alarm.canary_failed](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_metric_alarm) | resource |
| [aws_iam_role.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role) | resource |
| [aws_iam_role_policy.synthetic_policy](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy) | resource |
| [aws_s3_object.script](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_object) | resource |
| [aws_security_group.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group) | resource |
| [aws_synthetics_canary.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/synthetics_canary) | resource |
| [aws_synthetics_group.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/synthetics_group) | resource |
| [aws_synthetics_group_association.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/synthetics_group_association) | resource |
| [local_file.script_config](https://registry.terraform.io/providers/hashicorp/local/latest/docs/resources/file) | resource |
| [null_resource.this](https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource) | resource |
| [random_string.random](https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/string) | resource |
| [aws_caller_identity.current](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/caller_identity) | data source |
| [aws_iam_policy_document.assume_role_policy](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document) | data source |
| [aws_iam_policy_document.synthetic_policy](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document) | data source |
| [aws_region.current](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/region) | data source |
| [aws_s3_bucket.artifacts](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/s3_bucket) | data source |
| [aws_sns_topic.default_topic](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/sns_topic) | data source |
| [aws_sns_topic.topics_by_name](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/sns_topic) | data source |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_alarms_defaults"></a> [alarms\_defaults](#input\_alarms\_defaults) | Default settings for CloudWatch alarms | <pre>object({<br/>    enabled            = optional(bool, true)<br/>    evaluation_periods = optional(string, "1")<br/>    period             = optional(string, "900")<br/>    threshold          = optional(string, "90")<br/>    metric             = optional(string, "SuccessPercent")<br/>    condition          = optional(string, "LessThanThreshold")<br/>    description        = optional(string, "This alarm is triggered when the canary fails.")<br/>  })</pre> | `{}` | no |
| <a name="input_artifacts_bucket"></a> [artifacts\_bucket](#input\_artifacts\_bucket) | S3 bucket for storing Synthetics canary artifacts | `string` | `""` | no |
| <a name="input_create_alarms"></a> [create\_alarms](#input\_create\_alarms) | Flag to create CloudWatch alarms for the Synthetics canaries | `bool` | `true` | no |
| <a name="input_create_artifacts_bucket"></a> [create\_artifacts\_bucket](#input\_create\_artifacts\_bucket) | Flag to create the S3 bucket for Synthetics canary artifacts | `bool` | `false` | no |
| <a name="input_default_sns_topic_name"></a> [default\_sns\_topic\_name](#input\_default\_sns\_topic\_name) | Name of the SNS topic for notifications | `string` | `""` | no |
| <a name="input_extra_tags"></a> [extra\_tags](#input\_extra\_tags) | Extra tags to add to the resources | `map(string)` | `{}` | no |
| <a name="input_groups"></a> [groups](#input\_groups) | Settings for the synthetics configurations | `any` | `[]` | no |
| <a name="input_is_hub"></a> [is\_hub](#input\_is\_hub) | Is this a hub or spoke configuration? | `bool` | `false` | no |
| <a name="input_org"></a> [org](#input\_org) | Organization details | <pre>object({<br/>    organization_name = string<br/>    organization_unit = string<br/>    environment_type  = string<br/>    environment_name  = string<br/>  })</pre> | n/a | yes |
| <a name="input_spoke_def"></a> [spoke\_def](#input\_spoke\_def) | Spoke ID Number, must be a 3 digit number | `string` | `"001"` | no |
| <a name="input_vpc"></a> [vpc](#input\_vpc) | VPC configuration for the Synthetics canaries | <pre>object({<br/>    vpc_id             = string<br/>    subnet_ids         = list(string)<br/>    security_group_ids = optional(list(string), [])<br/>  })</pre> | n/a | yes |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_artifacts_bucket_arn"></a> [artifacts\_bucket\_arn](#output\_artifacts\_bucket\_arn) | n/a |
| <a name="output_artifacts_bucket_name"></a> [artifacts\_bucket\_name](#output\_artifacts\_bucket\_name) | n/a |
| <a name="output_synthetics_canaries"></a> [synthetics\_canaries](#output\_synthetics\_canaries) | n/a |
| <a name="output_synthetics_groups"></a> [synthetics\_groups](#output\_synthetics\_groups) | n/a |



## Help

**Got a question?** We got answers. 

File a GitHub [issue](https://github.com/cloudopsworks/terraform-module-aws-observability-synthetics/issues), send us an [email][email] or join our [Slack Community][slack].

[![README Commercial Support][readme_commercial_support_img]][readme_commercial_support_link]

## DevOps Tools

## Slack Community


## Newsletter

## Office Hours

## Contributing

### Bug Reports & Feature Requests

Please use the [issue tracker](https://github.com/cloudopsworks/terraform-module-aws-observability-synthetics/issues) to report any bugs or file feature requests.

### Developing




## Copyrights

Copyright © 2024-2025 [Cloud Ops Works LLC](https://cloudops.works)





## License 

[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0) 

See [LICENSE](LICENSE) for full details.

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      https://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.









## Trademarks

All other trademarks referenced herein are the property of their respective owners.

## About

This project is maintained by [Cloud Ops Works LLC][website]. 


### Contributors

|  [![Cristian Beraha][berahac_avatar]][berahac_homepage]<br/>[Cristian Beraha][berahac_homepage] |
|---|

  [berahac_homepage]: https://github.com/berahac
  [berahac_avatar]: https://github.com/berahac.png?size=50

[![README Footer][readme_footer_img]][readme_footer_link]
[![Beacon][beacon]][website]

  [logo]: https://cloudops.works/logo-300x69.svg
  [docs]: https://cowk.io/docs?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=docs
  [website]: https://cowk.io/homepage?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=website
  [github]: https://cowk.io/github?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=github
  [jobs]: https://cowk.io/jobs?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=jobs
  [hire]: https://cowk.io/hire?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=hire
  [slack]: https://cowk.io/slack?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=slack
  [linkedin]: https://cowk.io/linkedin?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=linkedin
  [twitter]: https://cowk.io/twitter?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=twitter
  [testimonial]: https://cowk.io/leave-testimonial?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=testimonial
  [office_hours]: https://cloudops.works/office-hours?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=office_hours
  [newsletter]: https://cowk.io/newsletter?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=newsletter
  [email]: https://cowk.io/email?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=email
  [commercial_support]: https://cowk.io/commercial-support?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=commercial_support
  [we_love_open_source]: https://cowk.io/we-love-open-source?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=we_love_open_source
  [terraform_modules]: https://cowk.io/terraform-modules?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=terraform_modules
  [readme_header_img]: https://cloudops.works/readme/header/img
  [readme_header_link]: https://cloudops.works/readme/header/link?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=readme_header_link
  [readme_footer_img]: https://cloudops.works/readme/footer/img
  [readme_footer_link]: https://cloudops.works/readme/footer/link?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=readme_footer_link
  [readme_commercial_support_img]: https://cloudops.works/readme/commercial-support/img
  [readme_commercial_support_link]: https://cloudops.works/readme/commercial-support/link?utm_source=github&utm_medium=readme&utm_campaign=cloudopsworks/terraform-module-aws-observability-synthetics&utm_content=readme_commercial_support_link
  [share_twitter]: https://twitter.com/intent/tweet/?text=Terraform+AWS+Observability+Synthetics+Module&url=https://github.com/cloudopsworks/terraform-module-aws-observability-synthetics
  [share_linkedin]: https://www.linkedin.com/shareArticle?mini=true&title=Terraform+AWS+Observability+Synthetics+Module&url=https://github.com/cloudopsworks/terraform-module-aws-observability-synthetics
  [share_reddit]: https://reddit.com/submit/?url=https://github.com/cloudopsworks/terraform-module-aws-observability-synthetics
  [share_facebook]: https://facebook.com/sharer/sharer.php?u=https://github.com/cloudopsworks/terraform-module-aws-observability-synthetics
  [share_googleplus]: https://plus.google.com/share?url=https://github.com/cloudopsworks/terraform-module-aws-observability-synthetics
  [share_email]: mailto:?subject=Terraform+AWS+Observability+Synthetics+Module&body=https://github.com/cloudopsworks/terraform-module-aws-observability-synthetics
  [beacon]: https://ga-beacon.cloudops.works/G-7XWMFVFXZT/cloudopsworks/terraform-module-aws-observability-synthetics?pixel&cs=github&cm=readme&an=terraform-module-aws-observability-synthetics
